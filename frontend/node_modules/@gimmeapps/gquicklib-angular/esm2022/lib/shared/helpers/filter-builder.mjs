export class FilterBuilder {
    constructor(filter) {
        filter = !filter ? { "and": [] } : JSON.parse(JSON.stringify(filter));
        if (this.isFilterCondition(filter))
            filter = { "and": [filter] };
        this.filter = filter;
    }
    insert(criteria) {
        const root = Object.keys(this.filter)[0];
        if (root === 'and') {
            this.filter.and.push(criteria);
        }
        else if (root === 'or') {
            this.filter.or.push(criteria);
        }
        else {
            throw new Error('Operador de grupo invÃ¡lido.');
        }
    }
    insertMany(criteria) {
        criteria.forEach(c => this.insert(c));
    }
    encode() {
        const json = JSON.stringify(this.filter);
        return btoa(json);
    }
    isFilterCondition(obj) {
        return (obj.hasOwnProperty('=') ||
            obj.hasOwnProperty('<') ||
            obj.hasOwnProperty('<=') ||
            obj.hasOwnProperty('>') ||
            obj.hasOwnProperty('>=') ||
            obj.hasOwnProperty('isnull'));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLWJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9ncXVpY2tsaWItYW5ndWxhci9zcmMvbGliL3NoYXJlZC9oZWxwZXJzL2ZpbHRlci1idWlsZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTBCQSxNQUFNLE9BQU8sYUFBYTtJQUd0QixZQUFZLE1BQTJCO1FBQ25DLE1BQU0sR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBdUIsQ0FBQTtRQUUzRixJQUFJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUM7WUFDOUIsTUFBTSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQTtRQUVoQyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtJQUN4QixDQUFDO0lBRUQsTUFBTSxDQUFDLFFBQTRCO1FBQy9CLE1BQU0sSUFBSSxHQUF3QixNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM5RCxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsTUFBeUIsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZELENBQUM7YUFBTSxJQUFJLElBQUksS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUN0QixJQUFJLENBQUMsTUFBd0IsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3JELENBQUM7YUFBTSxDQUFDO1lBQ0osTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1FBQ25ELENBQUM7SUFDTCxDQUFDO0lBRUQsVUFBVSxDQUFDLFFBQThCO1FBQ3JDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDekMsQ0FBQztJQUdELE1BQU07UUFDRixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUN4QyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUNyQixDQUFDO0lBRU8saUJBQWlCLENBQUMsR0FBUTtRQUM5QixPQUFPLENBQ0gsR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUM7WUFDdkIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUM7WUFDdkIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUM7WUFDeEIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUM7WUFDdkIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUM7WUFDeEIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FDL0IsQ0FBQztJQUNOLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIEZpbHRlckNvbmRpdGlvbk9wZXJhdG9yID0gXCI9XCIgfCBcIjxcIiB8IFwiPD1cIiB8IFwiPlwiIHwgXCI+PVwiIHwgJ2lzbnVsbCc7XG5leHBvcnQgdHlwZSBGaWx0ZXJHcm91cE9wZXJhdG9yID0gXCJhbmRcIiB8IFwib3JcIjtcblxuZXhwb3J0IHR5cGUgRmlsdGVyQ29uZGl0aW9uRXF1YWxzID0geyBcIj1cIjogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB9O1xuZXhwb3J0IHR5cGUgRmlsdGVyQ29uZGl0aW9uTGVzc1RoYW4gPSB7IFwiPFwiOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IH07XG5leHBvcnQgdHlwZSBGaWx0ZXJDb25kaXRpb25MZXNzVGhhbk9yRXF1YWwgPSB7IFwiPD1cIjogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB9O1xuZXhwb3J0IHR5cGUgRmlsdGVyQ29uZGl0aW9uR3JlYXRlclRoYW4gPSB7IFwiPlwiOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IH07XG5leHBvcnQgdHlwZSBGaWx0ZXJDb25kaXRpb25HcmVhdGVyVGhhbk9yRXF1YWwgPSB7IFwiPj1cIjogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB9O1xuZXhwb3J0IHR5cGUgRmlsdGVyQ29uZGl0aW9uSXNOdWxsID0geyAnaXNudWxsJzogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB9O1xuXG5leHBvcnQgdHlwZSBGaWx0ZXJDb25kaXRpb24gPVxuICAgIEZpbHRlckNvbmRpdGlvbkVxdWFscyB8XG4gICAgRmlsdGVyQ29uZGl0aW9uTGVzc1RoYW4gfFxuICAgIEZpbHRlckNvbmRpdGlvbkxlc3NUaGFuT3JFcXVhbCB8XG4gICAgRmlsdGVyQ29uZGl0aW9uR3JlYXRlclRoYW4gfFxuICAgIEZpbHRlckNvbmRpdGlvbkdyZWF0ZXJUaGFuT3JFcXVhbCB8XG4gICAgRmlsdGVyQ29uZGl0aW9uSXNOdWxsO1xuXG5leHBvcnQgdHlwZSBGaWx0ZXJHcm91cEFuZCA9IHsgXCJhbmRcIjogRmlsdGVyTG9naWNhbEdyb3VwW10gfTtcbmV4cG9ydCB0eXBlIEZpbHRlckdyb3VwT3IgPSB7IFwib3JcIjogRmlsdGVyTG9naWNhbEdyb3VwW10gfTtcbmV4cG9ydCB0eXBlIEZpbHRlckdyb3VwID0gRmlsdGVyR3JvdXBBbmQgfCBGaWx0ZXJHcm91cE9yO1xuXG5leHBvcnQgdHlwZSBGaWx0ZXJMb2dpY2FsR3JvdXAgPVxuICAgIEZpbHRlckNvbmRpdGlvbiB8XG4gICAgRmlsdGVyR3JvdXA7XG5cbmV4cG9ydCBjbGFzcyBGaWx0ZXJCdWlsZGVyIHtcbiAgICBmaWx0ZXI6IEZpbHRlckdyb3VwO1xuXG4gICAgY29uc3RydWN0b3IoZmlsdGVyPzogRmlsdGVyTG9naWNhbEdyb3VwKSB7XG4gICAgICAgIGZpbHRlciA9ICFmaWx0ZXIgPyB7IFwiYW5kXCI6IFtdIH0gOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGZpbHRlcikpIGFzIEZpbHRlckxvZ2ljYWxHcm91cFxuXG4gICAgICAgIGlmICh0aGlzLmlzRmlsdGVyQ29uZGl0aW9uKGZpbHRlcikpXG4gICAgICAgICAgICBmaWx0ZXIgPSB7IFwiYW5kXCI6IFtmaWx0ZXJdIH1cblxuICAgICAgICB0aGlzLmZpbHRlciA9IGZpbHRlclxuICAgIH1cblxuICAgIGluc2VydChjcml0ZXJpYTogRmlsdGVyTG9naWNhbEdyb3VwKSB7XG4gICAgICAgIGNvbnN0IHJvb3QgPSA8RmlsdGVyR3JvdXBPcGVyYXRvcj5PYmplY3Qua2V5cyh0aGlzLmZpbHRlcilbMF07XG4gICAgICAgIGlmIChyb290ID09PSAnYW5kJykge1xuICAgICAgICAgICAgKHRoaXMuZmlsdGVyIGFzIEZpbHRlckdyb3VwQW5kKS5hbmQucHVzaChjcml0ZXJpYSk7XG4gICAgICAgIH0gZWxzZSBpZiAocm9vdCA9PT0gJ29yJykge1xuICAgICAgICAgICAgKHRoaXMuZmlsdGVyIGFzIEZpbHRlckdyb3VwT3IpLm9yLnB1c2goY3JpdGVyaWEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPcGVyYWRvciBkZSBncnVwbyBpbnbDoWxpZG8uJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpbnNlcnRNYW55KGNyaXRlcmlhOiBGaWx0ZXJMb2dpY2FsR3JvdXBbXSkge1xuICAgICAgICBjcml0ZXJpYS5mb3JFYWNoKGMgPT4gdGhpcy5pbnNlcnQoYykpXG4gICAgfVxuXG5cbiAgICBlbmNvZGUoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZmlsdGVyKVxuICAgICAgICByZXR1cm4gYnRvYShqc29uKVxuICAgIH1cblxuICAgIHByaXZhdGUgaXNGaWx0ZXJDb25kaXRpb24ob2JqOiBhbnkpOiBvYmogaXMgRmlsdGVyQ29uZGl0aW9uIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG9iai5oYXNPd25Qcm9wZXJ0eSgnPScpIHx8XG4gICAgICAgICAgICBvYmouaGFzT3duUHJvcGVydHkoJzwnKSB8fFxuICAgICAgICAgICAgb2JqLmhhc093blByb3BlcnR5KCc8PScpIHx8XG4gICAgICAgICAgICBvYmouaGFzT3duUHJvcGVydHkoJz4nKSB8fFxuICAgICAgICAgICAgb2JqLmhhc093blByb3BlcnR5KCc+PScpIHx8XG4gICAgICAgICAgICBvYmouaGFzT3duUHJvcGVydHkoJ2lzbnVsbCcpXG4gICAgICAgICk7XG4gICAgfVxufSJdfQ==